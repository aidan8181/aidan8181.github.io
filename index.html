<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>PriceWatcher Demo</title>
</head>
<body onload="pageSetup()">
 
<span>&nbsp;</span>
<h3>Product One</h3>
<p id="product_one">Loading....</p>
<p/>
<h3>Product Two</h3>
<p id="product_two">Loading....</p>
<p/>
<h3>Product Three</h3>
<p id="product_three">Loading....</p>
<p/>
<h3>Product Four</h3>
<p id="product_four">Loading....</p>
<p/>
<h3>Product Five</h3>
<p id="product_five">Loading....</p>
<p/>
<h3>Product Six</h3>
<p id="product_six">Loading....</p>
<p/>
<h3>Product Seven</h3>
<p id="product_seven">Loading....</p>
<p/>
<h3>Product Eight</h3>
<p id="product_eight">Loading....</p>
<p/>
<h3>Product Nine</h3>
<p id="product_nine">Loading....</p>
<p/>
<h3>Product Ten</h3>
<p id="product_ten">Loading....</p>
<p/>
<p>
	Enter Price To Update To: <input type="text" id="update_price_to" value="0">
</p>
<button type="button" onclick="updatePrice()">Update Price</button>
<button type="button" onclick="resetData()">Reset</button>

<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-database.js"></script>
<script>
	function pageSetup() {
		var config = {
			apiKey: "AIzaSyAtpx_kTR6WkCSsK2SYiyptBAgETvuJNZw",
			authDomain: "pricewatchercore.firebaseapp.com",
			databaseURL: "https://pricewatchercore.firebaseio.com/",
			projectId: "pricewatchercore",
			storeageBucket: "pricewatchercore.appspot.com"
		};
		firebase.initializeApp(config);

		// Get a reference to the database service
		var database = firebase.database();

		var root = database.ref();

		var node = root.child("products");

		node.once("value").then(function(snapshot){
			snapshot.forEach(function(childSnapshot){
				var key = childSnapshot.key;
				var currentProductPrice = document.getElementById(key);
				currentProductPrice.innerHTML = "Â£" + childSnapshot.child("price").val();
			});
		});
	}
</script>
<script>
	function updatePrice() {
		var updateTo = document.getElementById("update_price_to");
		var database = firebase.database();
		var root = database.ref();
		var node = root.child("products");

		node.once("value").then(function(snapshot){
			snapshot.forEach(function(childSnapshot){
				var key = childSnapshot.key;
				var ref = childSnapshot.ref;

				ref.set({
					price: updateTo.value
				});

				console.log(ref);
			});
		}).then(function(){
			location.reload();
		});
	}
</script>
<script>
	function resetData() {
		var data = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100];

		var database = firebase.database();
		var root = database.ref();
		var node = root.child("products");
		var i = 0;

		node.once("value").then(function(snapshot){
			snapshot.forEach(function(childSnapshot){
				var key = childSnapshot.key;
				var ref = childSnapshot.ref;
				
				ref.set({
					price: data[i]
				});

				i++;
			});
		}).then(function(){
			location.reload();
		});
	}
</script>
	
	

 
</body>
</html>
