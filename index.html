<!doctype html>
<html lang="en">
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-database.js"></script>
	<script>
		var config = {
				apiKey: "AIzaSyAtpx_kTR6WkCSsK2SYiyptBAgETvuJNZw",
				authDomain: "pricewatchercore.firebaseapp.com",
				databaseURL: "https://pricewatchercore.firebaseio.com/",
				projectId: "pricewatchercore",
				storeageBucket: "pricewatchercore.appspot.com"
			};
		firebase.initializeApp(config);

		// Get a reference to the database service
		var database = firebase.database();

		var root = database.ref();

		var node = root.child("products");

		node.once("value").then(function(snapshot){
			snapshot.forEach(function(childSnapshot){
				var key = childSnapshot.key;
				var currentProductPrice = document.getElementById(key);
				currentProductPrice.innerHTML = "Â£" + childSnapshot.child("price").val();
			});
		});
	</script>
	<script>
		function updatePrice() {
			var updateTo = document.getElementById("update_price_to");
			var database = firebase.database();
			var root = database.ref();
			var node = root.child("products");

			node.once("value").then(function(snapshot){
				snapshot.forEach(function(childSnapshot){
					var key = childSnapshot.key;
					var ref = childSnapshot.ref;

					ref.set({
						price: updateTo.value
					});

					console.log(ref);
				});
			}).then(function(){
				location.reload();
			});
		}
	</script>
	<script>
		function resetData() {
			var data = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100];

			var database = firebase.database();
			var root = database.ref();
			var node = root.child("products");
			var i = 0;

			node.once("value").then(function(snapshot){
				snapshot.forEach(function(childSnapshot){
					var key = childSnapshot.key;
					var ref = childSnapshot.ref;

					ref.set({
						price: data[i]
					});

					i++;
				});
			}).then(function(){
				location.reload();
			});
		}
	</script>
  	<meta charset="utf-8">
  	<title>PriceWatcher Demo</title>
</head>
<body onload="wait()">
 	<script>
		 function wait(){
			jQuery(document).ready(function ($) {
			$(window).on('load', function () {
				setTimeout(function(){
					$('#preloader').fadeOut('slow', function () {
					});
				},2000);

				});  
			});
		 }
	</script>
<span>&nbsp;</span>
<h3>Product One</h3>
<p id="product_a"></p>
<p/>
<h3>Product Two</h3>
<p id="product_b">Loading....</p>
<p/>
<h3>Product Three</h3>
<p id="product_c">Loading....</p>
<p/>
<h3>Product Four</h3>
<p id="product_d">Loading....</p>
<p/>
<h3>Product Five</h3>
<p id="product_e">Loading....</p>
<p/>
<h3>Product Six</h3>
<p id="product_f">Loading....</p>
<p/>
<h3>Product Seven</h3>
<p id="product_g">Loading....</p>
<p/>
<h3>Product Eight</h3>
<p id="product_h">Loading....</p>
<p/>
<h3>Product Nine</h3>
<p id="product_i">Loading....</p>
<p/>
<h3>Product Ten</h3>
<p id="product_j">Loading....</p>
<p/>
<p>
	Enter Price To Update To: <input type="text" id="update_price_to" value="0">
</p>
<button type="button" onclick="updatePrice()">Update Price</button>
<button type="button" onclick="resetData()">Reset</button> 
</body>
</html>
